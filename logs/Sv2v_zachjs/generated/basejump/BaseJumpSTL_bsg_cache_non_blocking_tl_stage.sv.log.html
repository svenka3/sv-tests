<head>
  <style>
    .log { font-family: "Courier New", Consolas, monospace; font-size: 80%; }
    .test-failed { background-color: #ffaaaa; }
    .test-passed { background-color: #aaffaa; }
  </style>
</head>
<body>
<h3><a href="https://github.com/zachjs/sv2v" target="_blank">zachjs-sv2v</a></h3>
<pre class="test-passed">
description: Tests imported from basejump
rc: 0 (means success: 1)
tags: basejump
incdirs: /tmpfs/src/github/sv-tests/third_party/cores/basejump_stl/bsg_noc /tmpfs/src/github/sv-tests/third_party/cores/basejump_stl/bsg_misc /tmpfs/src/github/sv-tests/third_party/cores/basejump_stl/bsg_cache
top_module: 
type: parsing
mode: parsing
files: <a href="../../../../third_party/cores/basejump_stl/bsg_cache/bsg_cache_non_blocking_pkg.v.html" target="file-frame">third_party/cores/basejump_stl/bsg_cache/bsg_cache_non_blocking_pkg.v</a> <a href="../../../../third_party/cores/basejump_stl/bsg_cache/bsg_cache_pkg.v.html" target="file-frame">third_party/cores/basejump_stl/bsg_cache/bsg_cache_pkg.v</a> <a href="../../../../third_party/cores/basejump_stl/bsg_misc/bsg_defines.v.html" target="file-frame">third_party/cores/basejump_stl/bsg_misc/bsg_defines.v</a> <a href="../../../../third_party/cores/basejump_stl/bsg_cache/bsg_cache_non_blocking_tl_stage.v.html" target="file-frame">third_party/cores/basejump_stl/bsg_cache/bsg_cache_non_blocking_tl_stage.v</a>
defines: 
time_elapsed: 0.783s
ram usage: 19232 KB
</pre>
<pre class="log">

zachjs-sv2v -I/tmpfs/src/github/sv-tests/third_party/cores/basejump_stl/bsg_noc -I/tmpfs/src/github/sv-tests/third_party/cores/basejump_stl/bsg_misc -I/tmpfs/src/github/sv-tests/third_party/cores/basejump_stl/bsg_cache <a href="../../../../third_party/cores/basejump_stl/bsg_cache/bsg_cache_non_blocking_pkg.v.html" target="file-frame">third_party/cores/basejump_stl/bsg_cache/bsg_cache_non_blocking_pkg.v</a> <a href="../../../../third_party/cores/basejump_stl/bsg_cache/bsg_cache_pkg.v.html" target="file-frame">third_party/cores/basejump_stl/bsg_cache/bsg_cache_pkg.v</a> <a href="../../../../third_party/cores/basejump_stl/bsg_misc/bsg_defines.v.html" target="file-frame">third_party/cores/basejump_stl/bsg_misc/bsg_defines.v</a> <a href="../../../../third_party/cores/basejump_stl/bsg_cache/bsg_cache_non_blocking_tl_stage.v.html" target="file-frame">third_party/cores/basejump_stl/bsg_cache/bsg_cache_non_blocking_tl_stage.v</a>
module bsg_cache_non_blocking_tl_stage (
	clk_i,
	reset_i,
	v_i,
	id_i,
	addr_i,
	data_i,
	mask_i,
	decode_i,
	ready_o,
	data_mem_pkt_v_o,
	data_mem_pkt_o,
	data_mem_pkt_ready_i,
	block_loading_o,
	stat_mem_pkt_v_o,
	stat_mem_pkt_o,
	stat_mem_pkt_ready_i,
	miss_fifo_v_o,
	miss_fifo_entry_o,
	miss_fifo_ready_i,
	mgmt_v_o,
	valid_tl_o,
	lock_tl_o,
	tag_tl_o,
	decode_tl_o,
	addr_tl_o,
	id_tl_o,
	data_tl_o,
	tag_hit_way_o,
	tag_hit_found_o,
	mgmt_yumi_i,
	mhu_tag_mem_pkt_v_i,
	mhu_tag_mem_pkt_i,
	mhu_idle_i,
	recover_i,
	curr_mhu_way_id_i,
	curr_mhu_index_i,
	curr_mhu_v_i,
	curr_dma_way_id_i,
	curr_dma_index_i,
	curr_dma_v_i
);
	localparam [4:0] LB = 5&#39;b00000;
	localparam [4:0] LH = 5&#39;b00001;
	localparam [4:0] LW = 5&#39;b00010;
	localparam [4:0] LD = 5&#39;b00011;
	localparam [4:0] LBU = 5&#39;b00100;
	localparam [4:0] LHU = 5&#39;b00101;
	localparam [4:0] LWU = 5&#39;b00110;
	localparam [4:0] SB = 5&#39;b01000;
	localparam [4:0] SH = 5&#39;b01001;
	localparam [4:0] SW = 5&#39;b01010;
	localparam [4:0] SD = 5&#39;b01011;
	localparam [4:0] SM = 5&#39;b01101;
	localparam [4:0] BLOCK_LD = 5&#39;b01110;
	localparam [4:0] TAGST = 5&#39;b10000;
	localparam [4:0] TAGFL = 5&#39;b10001;
	localparam [4:0] TAGLV = 5&#39;b10010;
	localparam [4:0] TAGLA = 5&#39;b10011;
	localparam [4:0] AFL = 5&#39;b11000;
	localparam [4:0] AFLINV = 5&#39;b11001;
	localparam [4:0] AINV = 5&#39;b11010;
	localparam [4:0] ALOCK = 5&#39;b11011;
	localparam [4:0] AUNLOCK = 5&#39;b11100;
	localparam [2:0] e_tag_read = 0;
	localparam [2:0] e_tag_store = 1;
	localparam [2:0] e_tag_set_tag = 2;
	localparam [2:0] e_tag_set_tag_and_lock = 3;
	localparam [2:0] e_tag_invalidate = 4;
	localparam [2:0] e_tag_lock = 5;
	localparam [2:0] e_tag_unlock = 6;
	localparam [2:0] e_stat_read = 0;
	localparam [2:0] e_stat_clear_dirty = 1;
	localparam [2:0] e_stat_set_lru = 2;
	localparam [2:0] e_stat_set_lru_and_dirty = 3;
	localparam [2:0] e_stat_set_lru_and_clear_dirty = 4;
	localparam [2:0] e_stat_reset = 5;
	localparam [1:0] e_miss_fifo_dequeue = 0;
	localparam [1:0] e_miss_fifo_skip = 1;
	localparam [1:0] e_miss_fifo_invalidate = 2;
	localparam [3:0] MHU_IDLE = 0;
	localparam [3:0] MGMT_OP = 1;
	localparam [3:0] SEND_MGMT_DMA = 2;
	localparam [3:0] WAIT_MGMT_DMA = 3;
	localparam [3:0] READ_TAG1 = 4;
	localparam [3:0] SEND_DMA_REQ1 = 5;
	localparam [3:0] WAIT_DMA_DONE = 6;
	localparam [3:0] DEQUEUE_MODE = 7;
	localparam [3:0] READ_TAG2 = 8;
	localparam [3:0] SEND_DMA_REQ2 = 9;
	localparam [3:0] SCAN_MODE = 10;
	localparam [3:0] RECOVER = 11;
	parameter _sv2v_width_id_width_p = 24;
	parameter [_sv2v_width_id_width_p - 1:0] id_width_p = &#34;inv&#34;;
	parameter _sv2v_width_addr_width_p = 24;
	parameter [_sv2v_width_addr_width_p - 1:0] addr_width_p = &#34;inv&#34;;
	parameter _sv2v_width_data_width_p = 24;
	parameter [_sv2v_width_data_width_p - 1:0] data_width_p = &#34;inv&#34;;
	parameter _sv2v_width_ways_p = 24;
	parameter [_sv2v_width_ways_p - 1:0] ways_p = &#34;inv&#34;;
	parameter _sv2v_width_sets_p = 24;
	parameter [_sv2v_width_sets_p - 1:0] sets_p = &#34;inv&#34;;
	parameter _sv2v_width_block_size_in_words_p = 24;
	parameter [_sv2v_width_block_size_in_words_p - 1:0] block_size_in_words_p = &#34;inv&#34;;
	parameter lg_ways_lp = (ways_p == 1 ? 1 : $clog2(ways_p));
	parameter lg_sets_lp = (sets_p == 1 ? 1 : $clog2(sets_p));
	parameter lg_block_size_in_words_lp = (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p));
	parameter data_mask_width_lp = data_width_p &gt;&gt; 3;
	parameter byte_sel_width_lp = ((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3));
	parameter tag_width_lp = ((addr_width_p - lg_sets_lp) - lg_block_size_in_words_lp) - byte_sel_width_lp;
	parameter data_mem_pkt_width_lp = (((((5 + ((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3))) + (ways_p == 1 ? 1 : $clog2(ways_p))) + (sets_p == 1 ? 1 : $clog2(sets_p))) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + data_width_p) + (data_width_p &gt;&gt; 3);
	parameter stat_mem_pkt_width_lp = (3 + (ways_p == 1 ? 1 : $clog2(ways_p))) + (sets_p == 1 ? 1 : $clog2(sets_p));
	parameter tag_mem_pkt_width_lp = ((((ways_p == 1 ? 1 : $clog2(ways_p)) + (sets_p == 1 ? 1 : $clog2(sets_p))) + data_width_p) + tag_width_lp) + 3;
	parameter miss_fifo_entry_width_lp = (((6 + id_width_p) + addr_width_p) + data_width_p) + (data_width_p &gt;&gt; 3);
	input clk_i;
	input reset_i;
	input v_i;
	input [id_width_p - 1:0] id_i;
	input [addr_width_p - 1:0] addr_i;
	input [data_width_p - 1:0] data_i;
	input [data_mask_width_lp - 1:0] mask_i;
	input wire [16:0] decode_i;
	output reg ready_o;
	output reg data_mem_pkt_v_o;
	output wire [data_mem_pkt_width_lp - 1:0] data_mem_pkt_o;
	input data_mem_pkt_ready_i;
	output wire block_loading_o;
	output reg stat_mem_pkt_v_o;
	output wire [stat_mem_pkt_width_lp - 1:0] stat_mem_pkt_o;
	input stat_mem_pkt_ready_i;
	output reg miss_fifo_v_o;
	output wire [miss_fifo_entry_width_lp - 1:0] miss_fifo_entry_o;
	input miss_fifo_ready_i;
	output wire mgmt_v_o;
	output wire [ways_p - 1:0] valid_tl_o;
	output wire [ways_p - 1:0] lock_tl_o;
	output wire [(ways_p * tag_width_lp) - 1:0] tag_tl_o;
	output wire [16:0] decode_tl_o;
	output wire [addr_width_p - 1:0] addr_tl_o;
	output wire [id_width_p - 1:0] id_tl_o;
	output wire [data_width_p - 1:0] data_tl_o;
	output wire [lg_ways_lp - 1:0] tag_hit_way_o;
	output wire tag_hit_found_o;
	input mgmt_yumi_i;
	input mhu_tag_mem_pkt_v_i;
	input [tag_mem_pkt_width_lp - 1:0] mhu_tag_mem_pkt_i;
	input mhu_idle_i;
	input recover_i;
	input [lg_ways_lp - 1:0] curr_mhu_way_id_i;
	input [lg_sets_lp - 1:0] curr_mhu_index_i;
	input curr_mhu_v_i;
	input [lg_ways_lp - 1:0] curr_dma_way_id_i;
	input [lg_sets_lp - 1:0] curr_dma_index_i;
	input curr_dma_v_i;
	localparam block_offset_width_lp = byte_sel_width_lp + lg_block_size_in_words_lp;
	wire [(((((5 + ((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3))) + (ways_p == 1 ? 1 : $clog2(ways_p))) + ((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p)))) + data_width_p) + (data_width_p &gt;&gt; 3)) - 1:0] data_mem_pkt;
	wire [((3 + (ways_p == 1 ? 1 : $clog2(ways_p))) + (sets_p == 1 ? 1 : $clog2(sets_p))) - 1:0] stat_mem_pkt;
	wire [((((ways_p == 1 ? 1 : $clog2(ways_p)) + (sets_p == 1 ? 1 : $clog2(sets_p))) + data_width_p) + tag_width_lp) + 2:0] mhu_tag_mem_pkt;
	wire [((((6 + id_width_p) + addr_width_p) + data_width_p) + (data_width_p &gt;&gt; 3)) - 1:0] miss_fifo_entry;
	assign data_mem_pkt_o = data_mem_pkt;
	assign stat_mem_pkt_o = stat_mem_pkt;
	assign mhu_tag_mem_pkt = mhu_tag_mem_pkt_i;
	assign miss_fifo_entry_o = miss_fifo_entry;
	reg v_tl_r;
	reg v_tl_n;
	reg block_mode_r;
	reg block_mode_n;
	reg tl_we;
	reg [16:0] decode_tl_r;
	reg [id_width_p - 1:0] id_tl_r;
	reg [addr_width_p - 1:0] addr_tl_r;
	reg [data_width_p - 1:0] data_tl_r;
	reg [data_mask_width_lp - 1:0] mask_tl_r;
	wire mgmt_op_v;
	assign decode_tl_o = decode_tl_r;
	assign id_tl_o = id_tl_r;
	assign addr_tl_o = addr_tl_r;
	assign data_tl_o = data_tl_r;
	assign mgmt_op_v = decode_i[0] &amp; v_i;
	wire [lg_sets_lp - 1:0] addr_index;
	wire [lg_ways_lp - 1:0] addr_way;
	assign addr_index = addr_i[block_offset_width_lp+:lg_sets_lp];
	assign addr_way = addr_i[block_offset_width_lp + lg_sets_lp+:lg_ways_lp];
	wire [tag_width_lp - 1:0] addr_tag_tl;
	wire [lg_sets_lp - 1:0] addr_index_tl;
	assign addr_tag_tl = addr_tl_r[block_offset_width_lp + lg_sets_lp+:tag_width_lp];
	assign addr_index_tl = addr_tl_r[block_offset_width_lp+:lg_sets_lp];
	assign block_loading_o = block_mode_r;
	always @(posedge clk_i) begin
		if (reset_i) begin
			v_tl_r &lt;= 1&#39;b0;
			block_mode_r &lt;= 1&#39;b0;
		end
		else begin
			v_tl_r &lt;= v_tl_n;
			block_mode_r &lt;= block_mode_n;
		end
		if (reset_i)
			{decode_tl_r, id_tl_r, addr_tl_r, data_tl_r, mask_tl_r} &lt;= {(((17 + id_width_p) + addr_width_p) + data_width_p) + data_mask_width_lp {1&#39;sb0}};
		else if (tl_we) begin
			decode_tl_r &lt;= decode_i;
			id_tl_r &lt;= id_i;
			addr_tl_r &lt;= addr_i;
			data_tl_r &lt;= data_i;
			mask_tl_r &lt;= mask_i;
		end
	end
	reg counter_clear;
	reg counter_up;
	wire [lg_block_size_in_words_lp - 1:0] counter_r;
	wire counter_max;
	wire clk_i;
	wire reset_i;
	bsg_counter_clear_up #(
		.max_val_p(block_size_in_words_p - 1),
		.init_val_p(0)
	) block_counter(
		.clk_i(clk_i),
		.reset_i(reset_i),
		.clear_i(counter_clear),
		.up_i(counter_up),
		.count_o(counter_r)
	);
	assign counter_max = counter_r == (block_size_in_words_p - 1);
	reg tag_mem_v_li;
	reg [((((ways_p == 1 ? 1 : $clog2(ways_p)) + (sets_p == 1 ? 1 : $clog2(sets_p))) + data_width_p) + tag_width_lp) + 2:0] tag_mem_pkt;
	wire [ways_p - 1:0] valid_tl;
	wire [ways_p - 1:0] lock_tl;
	wire [(ways_p * tag_width_lp) - 1:0] tag_tl;
	bsg_cache_non_blocking_tag_mem #(
		.sets_p(sets_p),
		.ways_p(ways_p),
		.data_width_p(data_width_p),
		.tag_width_p(tag_width_lp)
	) tag_mem0(
		.clk_i(clk_i),
		.reset_i(reset_i),
		.v_i(tag_mem_v_li),
		.tag_mem_pkt_i(tag_mem_pkt),
		.valid_o(valid_tl),
		.lock_o(lock_tl),
		.tag_o(tag_tl)
	);
	assign valid_tl_o = valid_tl;
	assign lock_tl_o = lock_tl;
	assign tag_tl_o = tag_tl;
	wire [ways_p - 1:0] tag_hit;
	generate
		genvar i;
		for (i = 0; i &lt; ways_p; i = i + 1) assign tag_hit[i] = (tag_tl[i * tag_width_lp+:tag_width_lp] == addr_tag_tl) &amp; valid_tl[i];
	endgenerate
	wire [lg_ways_lp - 1:0] tag_hit_way;
	bsg_priority_encode #(
		.width_p(ways_p),
		.lo_to_hi_p(1)
	) tag_hit_pe(
		.i(tag_hit),
		.addr_o(tag_hit_way),
		.v_o()
	);
	assign tag_hit_way_o = tag_hit_way;
	wire tag_hit_found = |tag_hit;
	assign tag_hit_found_o = tag_hit_found;
	wire mhu_miss_match = (curr_mhu_v_i &amp; (tag_hit_way == curr_mhu_way_id_i)) &amp; (curr_mhu_index_i == addr_index_tl);
	wire dma_miss_match = (curr_dma_v_i &amp; (tag_hit_way == curr_dma_way_id_i)) &amp; (curr_dma_index_i == addr_index_tl);
	assign data_mem_pkt[5 + (((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3)) + ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1)))))] = decode_tl_r[12];
	assign data_mem_pkt[(ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1)))-:(((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1)))) &gt;= (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + (data_width_p &gt;&gt; 3))) ? (((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1)))) - (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + (data_width_p &gt;&gt; 3)))) + 1 : ((((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + (data_width_p &gt;&gt; 3))) - ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))))) + 1)] = tag_hit_way;
	assign data_mem_pkt[((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))-:((((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))) &gt;= (data_width_p + (data_width_p &gt;&gt; 3)) ? ((((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))) - (data_width_p + (data_width_p &gt;&gt; 3))) + 1 : ((data_width_p + (data_width_p &gt;&gt; 3)) - (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1)))) + 1)] = (decode_tl_r[11] ? {addr_tl_r[block_offset_width_lp+:lg_sets_lp], counter_r} : addr_tl_r[byte_sel_width_lp+:lg_block_size_in_words_lp + lg_sets_lp]);
	assign data_mem_pkt[4 + (((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3)) + ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1)))))] = decode_tl_r[14];
	function automatic [1:0] sv2v_cast_2;
		input reg [1:0] inp;
		sv2v_cast_2 = inp;
	endfunction
	assign data_mem_pkt[2 + (((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3)) + ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1)))))-:((2 + (((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3)) + ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1)))))) &gt;= (((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3)) + ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + (data_width_p &gt;&gt; 3))))) ? ((2 + (((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3)) + ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1)))))) - (((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3)) + ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + (data_width_p &gt;&gt; 3)))))) + 1 : ((((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3)) + ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + (data_width_p &gt;&gt; 3))))) - (2 + (((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3)) + ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))))))) + 1)] = (decode_tl_r[11] ? sv2v_cast_2($clog2(data_width_p &gt;&gt; 3)) : decode_tl_r[16-:2]);
	assign data_mem_pkt[((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3)) + ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))))-:((((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3)) + ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))))) &gt;= ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + (data_width_p &gt;&gt; 3)))) ? ((((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3)) + ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))))) - ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + (data_width_p &gt;&gt; 3))))) + 1 : (((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + (data_width_p &gt;&gt; 3)))) - (((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3)) + ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1)))))) + 1)] = (decode_tl_r[11] ? {byte_sel_width_lp {1&#39;b0}} : addr_tl_r[0+:byte_sel_width_lp]);
	assign data_mem_pkt[data_width_p + ((data_width_p &gt;&gt; 3) - 1)-:((data_width_p + ((data_width_p &gt;&gt; 3) - 1)) &gt;= (data_width_p &gt;&gt; 3) ? ((data_width_p + ((data_width_p &gt;&gt; 3) - 1)) - (data_width_p &gt;&gt; 3)) + 1 : ((data_width_p &gt;&gt; 3) - (data_width_p + ((data_width_p &gt;&gt; 3) - 1))) + 1)] = data_tl_r;
	assign data_mem_pkt[(data_width_p &gt;&gt; 3) - 1-:data_width_p &gt;&gt; 3] = mask_tl_r;
	assign data_mem_pkt[3 + (((data_width_p &gt;&gt; 3) == 1 ? 1 : $clog2(data_width_p &gt;&gt; 3)) + ((ways_p == 1 ? 1 : $clog2(ways_p)) + (((sets_p == 1 ? 1 : $clog2(sets_p)) + (block_size_in_words_p == 1 ? 1 : $clog2(block_size_in_words_p))) + (data_width_p + ((data_width_p &gt;&gt; 3) - 1)))))] = decode_tl_r[10];
	assign stat_mem_pkt[(ways_p == 1 ? 1 : $clog2(ways_p)) + ((sets_p == 1 ? 1 : $clog2(sets_p)) - 1)-:(((ways_p == 1 ? 1 : $clog2(ways_p)) + ((sets_p == 1 ? 1 : $clog2(sets_p)) - 1)) &gt;= (sets_p == 1 ? 1 : $clog2(sets_p)) ? (((ways_p == 1 ? 1 : $clog2(ways_p)) + ((sets_p == 1 ? 1 : $clog2(sets_p)) - 1)) - (sets_p == 1 ? 1 : $clog2(sets_p))) + 1 : ((sets_p == 1 ? 1 : $clog2(sets_p)) - ((ways_p == 1 ? 1 : $clog2(ways_p)) + ((sets_p == 1 ? 1 : $clog2(sets_p)) - 1))) + 1)] = tag_hit_way;
	assign stat_mem_pkt[(sets_p == 1 ? 1 : $clog2(sets_p)) - 1-:(sets_p == 1 ? 1 : $clog2(sets_p))] = addr_index_tl;
	assign stat_mem_pkt[3 + ((ways_p == 1 ? 1 : $clog2(ways_p)) + ((sets_p == 1 ? 1 : $clog2(sets_p)) - 1))-:((3 + ((ways_p == 1 ? 1 : $clog2(ways_p)) + ((sets_p == 1 ? 1 : $clog2(sets_p)) - 1))) &gt;= ((ways_p == 1 ? 1 : $clog2(ways_p)) + (sets_p == 1 ? 1 : $clog2(sets_p))) ? ((3 + ((ways_p == 1 ? 1 : $clog2(ways_p)) + ((sets_p == 1 ? 1 : $clog2(sets_p)) - 1))) - ((ways_p == 1 ? 1 : $clog2(ways_p)) + (sets_p == 1 ? 1 : $clog2(sets_p)))) + 1 : (((ways_p == 1 ? 1 : $clog2(ways_p)) + (sets_p == 1 ? 1 : $clog2(sets_p))) - (3 + ((ways_p == 1 ? 1 : $clog2(ways_p)) + ((sets_p == 1 ? 1 : $clog2(sets_p)) - 1)))) + 1)] = (decode_tl_r[12] ? e_stat_set_lru_and_dirty : e_stat_set_lru);
	assign miss_fifo_entry[6 + (id_width_p + (addr_width_p + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))))] = decode_tl_r[12];
	assign miss_fifo_entry[5 + (id_width_p + (addr_width_p + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))))] = decode_tl_r[11];
	assign miss_fifo_entry[4 + (id_width_p + (addr_width_p + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))))-:((4 + (id_width_p + (addr_width_p + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))))) &gt;= (2 + (id_width_p + (addr_width_p + (data_width_p + (data_width_p &gt;&gt; 3))))) ? ((4 + (id_width_p + (addr_width_p + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))))) - (2 + (id_width_p + (addr_width_p + (data_width_p + (data_width_p &gt;&gt; 3)))))) + 1 : ((2 + (id_width_p + (addr_width_p + (data_width_p + (data_width_p &gt;&gt; 3))))) - (4 + (id_width_p + (addr_width_p + (data_width_p + ((data_width_p &gt;&gt; 3) - 1)))))) + 1)] = decode_tl_r[16-:2];
	assign miss_fifo_entry[id_width_p + (addr_width_p + (data_width_p + ((data_width_p &gt;&gt; 3) - 1)))-:((id_width_p + (addr_width_p + (data_width_p + ((data_width_p &gt;&gt; 3) - 1)))) &gt;= (addr_width_p + (data_width_p + (data_width_p &gt;&gt; 3))) ? ((id_width_p + (addr_width_p + (data_width_p + ((data_width_p &gt;&gt; 3) - 1)))) - (addr_width_p + (data_width_p + (data_width_p &gt;&gt; 3)))) + 1 : ((addr_width_p + (data_width_p + (data_width_p &gt;&gt; 3))) - (id_width_p + (addr_width_p + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))))) + 1)] = id_tl_r;
	assign miss_fifo_entry[addr_width_p + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))-:((addr_width_p + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))) &gt;= (data_width_p + (data_width_p &gt;&gt; 3)) ? ((addr_width_p + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))) - (data_width_p + (data_width_p &gt;&gt; 3))) + 1 : ((data_width_p + (data_width_p &gt;&gt; 3)) - (addr_width_p + (data_width_p + ((data_width_p &gt;&gt; 3) - 1)))) + 1)] = addr_tl_r;
	assign miss_fifo_entry[data_width_p + ((data_width_p &gt;&gt; 3) - 1)-:((data_width_p + ((data_width_p &gt;&gt; 3) - 1)) &gt;= (data_width_p &gt;&gt; 3) ? ((data_width_p + ((data_width_p &gt;&gt; 3) - 1)) - (data_width_p &gt;&gt; 3)) + 1 : ((data_width_p &gt;&gt; 3) - (data_width_p + ((data_width_p &gt;&gt; 3) - 1))) + 1)] = data_tl_r;
	assign miss_fifo_entry[2 + (id_width_p + (addr_width_p + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))))] = decode_tl_r[14];
	assign miss_fifo_entry[(data_width_p &gt;&gt; 3) - 1-:data_width_p &gt;&gt; 3] = mask_tl_r;
	assign miss_fifo_entry[1 + (id_width_p + (addr_width_p + (data_width_p + ((data_width_p &gt;&gt; 3) - 1))))] = decode_tl_r[10];
	wire miss_tl;
	wire ld_st_hit;
	wire block_ld_hit;
	wire ld_st_miss;
	wire ld_st_ready;
	wire mgmt_op_tl;
	assign miss_tl = (tag_hit_found ? mhu_miss_match | dma_miss_match : 1&#39;b1);
	assign ld_st_hit = (v_tl_r &amp; (decode_tl_r[13] | decode_tl_r[12])) &amp; ~miss_tl;
	assign block_ld_hit = (v_tl_r &amp; decode_tl_r[11]) &amp; ~miss_tl;
	assign ld_st_miss = (v_tl_r &amp; ((decode_tl_r[13] | decode_tl_r[12]) | decode_tl_r[11])) &amp; miss_tl;
	assign ld_st_ready = data_mem_pkt_ready_i &amp; stat_mem_pkt_ready_i;
	assign mgmt_op_tl = v_tl_r &amp; decode_tl_r[0];
	assign mgmt_v_o = mgmt_op_tl;
	always @(*) begin
		ready_o = 1&#39;b0;
		data_mem_pkt_v_o = 1&#39;b0;
		stat_mem_pkt_v_o = 1&#39;b0;
		miss_fifo_v_o = 1&#39;b0;
		v_tl_n = v_tl_r;
		tl_we = 1&#39;b0;
		tag_mem_v_li = 1&#39;b0;
		tag_mem_pkt = mhu_tag_mem_pkt;
		block_mode_n = block_mode_r;
		counter_up = 1&#39;b0;
		counter_clear = 1&#39;b0;
		if (mgmt_op_tl) begin
			ready_o = mgmt_yumi_i &amp; ~mhu_tag_mem_pkt_v_i;
			v_tl_n = (mgmt_yumi_i ? (mhu_tag_mem_pkt_v_i ? 1&#39;b0 : v_i) : v_tl_r);
			tl_we = (mgmt_yumi_i &amp; v_i) &amp; ~mhu_tag_mem_pkt_v_i;
			tag_mem_v_li = mgmt_yumi_i &amp; (v_i | mhu_tag_mem_pkt_v_i);
			if (mhu_tag_mem_pkt_v_i)
				tag_mem_pkt = mhu_tag_mem_pkt;
			else begin
				tag_mem_pkt[(ways_p == 1 ? 1 : $clog2(ways_p)) + ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2)))-:(((ways_p == 1 ? 1 : $clog2(ways_p)) + ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2)))) &gt;= ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 3))) ? (((ways_p == 1 ? 1 : $clog2(ways_p)) + ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2)))) - ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 3)))) + 1 : (((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 3))) - ((ways_p == 1 ? 1 : $clog2(ways_p)) + ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))))) + 1)] = addr_way;
				tag_mem_pkt[(sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))-:(((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))) &gt;= (data_width_p + (tag_width_lp + 3)) ? (((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))) - (data_width_p + (tag_width_lp + 3))) + 1 : ((data_width_p + (tag_width_lp + 3)) - ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2)))) + 1)] = addr_index;
				tag_mem_pkt[data_width_p + (tag_width_lp + 2)-:((data_width_p + (tag_width_lp + 2)) &gt;= (tag_width_lp + 3) ? ((data_width_p + (tag_width_lp + 2)) - (tag_width_lp + 3)) + 1 : ((tag_width_lp + 3) - (data_width_p + (tag_width_lp + 2))) + 1)] = data_i;
				tag_mem_pkt[2-:3] = (decode_i[9] ? e_tag_store : e_tag_read);
			end
		end
		else if (recover_i) begin
			tag_mem_v_li = v_tl_r;
			tag_mem_pkt[(sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))-:(((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))) &gt;= (data_width_p + (tag_width_lp + 3)) ? (((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))) - (data_width_p + (tag_width_lp + 3))) + 1 : ((data_width_p + (tag_width_lp + 3)) - ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2)))) + 1)] = addr_index_tl;
			tag_mem_pkt[2-:3] = e_tag_read;
		end
		else if (mhu_tag_mem_pkt_v_i) begin
			tag_mem_v_li = 1&#39;b1;
			tag_mem_pkt = mhu_tag_mem_pkt;
		end
		else if (ld_st_hit) begin
			data_mem_pkt_v_o = ld_st_ready;
			stat_mem_pkt_v_o = ld_st_ready;
			ready_o = ld_st_ready &amp; ~mgmt_op_v;
			v_tl_n = (ld_st_ready ? (mgmt_op_v ? 1&#39;b0 : v_i) : v_tl_r);
			tl_we = (ld_st_ready &amp; v_i) &amp; ~decode_i[0];
			tag_mem_v_li = (ld_st_ready &amp; v_i) &amp; ~decode_i[0];
			tag_mem_pkt[(sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))-:(((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))) &gt;= (data_width_p + (tag_width_lp + 3)) ? (((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))) - (data_width_p + (tag_width_lp + 3))) + 1 : ((data_width_p + (tag_width_lp + 3)) - ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2)))) + 1)] = addr_index;
			tag_mem_pkt[2-:3] = e_tag_read;
		end
		else if (ld_st_miss) begin
			miss_fifo_v_o = 1&#39;b1;
			ready_o = miss_fifo_ready_i &amp; ~mgmt_op_v;
			v_tl_n = (miss_fifo_ready_i ? (mgmt_op_v ? 1&#39;b0 : v_i) : v_tl_r);
			tl_we = (miss_fifo_ready_i &amp; v_i) &amp; ~decode_i[0];
			tag_mem_v_li = (miss_fifo_ready_i &amp; v_i) &amp; ~decode_i[0];
			tag_mem_pkt[(sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))-:(((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))) &gt;= (data_width_p + (tag_width_lp + 3)) ? (((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))) - (data_width_p + (tag_width_lp + 3))) + 1 : ((data_width_p + (tag_width_lp + 3)) - ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2)))) + 1)] = addr_index;
			tag_mem_pkt[2-:3] = e_tag_read;
		end
		else if (block_ld_hit) begin
			data_mem_pkt_v_o = (counter_max ? ld_st_ready : data_mem_pkt_ready_i);
			stat_mem_pkt_v_o = (counter_max ? ld_st_ready : 1&#39;b0);
			ready_o = (ld_st_ready &amp; ~mgmt_op_v) &amp; counter_max;
			v_tl_n = (ld_st_ready &amp; counter_max ? (mgmt_op_v ? 1&#39;b0 : v_i) : v_tl_r);
			tl_we = ((ld_st_ready &amp; v_i) &amp; ~decode_i[0]) &amp; counter_max;
			tag_mem_v_li = ((ld_st_ready &amp; v_i) &amp; ~decode_i[0]) &amp; counter_max;
			tag_mem_pkt[(sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))-:(((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))) &gt;= (data_width_p + (tag_width_lp + 3)) ? (((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))) - (data_width_p + (tag_width_lp + 3))) + 1 : ((data_width_p + (tag_width_lp + 3)) - ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2)))) + 1)] = addr_index;
			tag_mem_pkt[2-:3] = e_tag_read;
			counter_up = ld_st_ready &amp; ~counter_max;
			counter_clear = ld_st_ready &amp; counter_max;
			block_mode_n = ((counter_max ? ld_st_ready : data_mem_pkt_ready_i) ? (block_mode_r ? ~counter_max : 1&#39;b1) : block_mode_r);
		end
		else begin
			ready_o = (mgmt_op_v ? mhu_idle_i : 1&#39;b1);
			v_tl_n = (mgmt_op_v ? (mhu_idle_i ? v_i : 1&#39;b0) : v_i);
			tl_we = (mgmt_op_v ? (mhu_idle_i ? v_i : 1&#39;b0) : v_i);
			tag_mem_v_li = (mgmt_op_v ? (mhu_idle_i ? v_i : 1&#39;b0) : v_i);
			tag_mem_pkt[(ways_p == 1 ? 1 : $clog2(ways_p)) + ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2)))-:(((ways_p == 1 ? 1 : $clog2(ways_p)) + ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2)))) &gt;= ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 3))) ? (((ways_p == 1 ? 1 : $clog2(ways_p)) + ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2)))) - ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 3)))) + 1 : (((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 3))) - ((ways_p == 1 ? 1 : $clog2(ways_p)) + ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))))) + 1)] = addr_way;
			tag_mem_pkt[(sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))-:(((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))) &gt;= (data_width_p + (tag_width_lp + 3)) ? (((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2))) - (data_width_p + (tag_width_lp + 3))) + 1 : ((data_width_p + (tag_width_lp + 3)) - ((sets_p == 1 ? 1 : $clog2(sets_p)) + (data_width_p + (tag_width_lp + 2)))) + 1)] = addr_index;
			tag_mem_pkt[data_width_p + (tag_width_lp + 2)-:((data_width_p + (tag_width_lp + 2)) &gt;= (tag_width_lp + 3) ? ((data_width_p + (tag_width_lp + 2)) - (tag_width_lp + 3)) + 1 : ((tag_width_lp + 3) - (data_width_p + (tag_width_lp + 2))) + 1)] = data_i;
			tag_mem_pkt[2-:3] = (decode_i[9] ? e_tag_store : e_tag_read);
		end
	end
	always @(negedge clk_i) begin
		if (~reset_i &amp; v_tl_r)
			;
		if (~reset_i &amp; v_tl_r)
			;
	end
endmodule

</pre>
</body>